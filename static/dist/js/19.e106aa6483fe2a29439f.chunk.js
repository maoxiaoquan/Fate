(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{"365b1ecbd6128eb6b31d":function(e,t,a){"use strict";a.r(t);a("dd1ecc38b32295d28890");var n=a("22b0af3c86168fc91a4c"),r=(a("55aa7ca4a0a8a48c9e61"),a("fbb809245daa6bdefd4c")),o=(a("1512f71111e678bdc301"),a("54d09d2169758098c3cb")),i=(a("0b403e9de8531798815b"),a("f93e88075e502b066463")),c=(a("2f3650d48acaa2aad9af"),a("29279c61aa3570bb3814")),l=(a("ec4109717b506939221b"),a("1d945b5a0267d56ef3e4")),s=(a("111ae47c12716851841c"),a("c206fca74049d124e35c")),u=(a("5d1c41d92d0de728d7d6"),a("e58a8e55a4befb201898")),_=a("3f489e511c06ad55a145"),d=a.n(_),f=a("7786c0fe89da92a9c05c"),p=a("5d6d9fb93f54f7c9adf8"),m=(a("489c92a1cf4a91fcd1a4"),a("ebc36760de3f885a3395")),h=a("561c3bf1d85c7e61ff95");function b(e){return(b="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function v(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){x(e,t,a[t])})}return e}function O(e,t,a,n,r,o,i){try{var c=e[o](i),l=c.value}catch(e){return void a(e)}c.done?t(l):Promise.resolve(l).then(n,r)}function w(e){return function(){var t=this,a=arguments;return new Promise(function(n,r){var o=e.apply(t,a);function i(e){O(o,n,r,i,c,"next",e)}function c(e){O(o,n,r,i,c,"throw",e)}i(void 0)})}}function E(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var j=u.a.TreeNode,R=s.a.Item,T=(l.a.Option,c.a.confirm),N=i.a.TextArea,P=function(e){function t(e){var a,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=k(t).call(this,e),a=!r||"object"!==b(r)&&"function"!==typeof r?C(n):r,x(C(C(a)),"showModal",function(){a.setState({visible_create_role_modal:!0,is_create:!0}),a.init_role_from()}),x(C(C(a)),"init_tree_data",function(e){var t=[];return console.log("val",e),a.props.state_admin_authority.admin_authority_source_list.map(function(a){2===Number(a.authority_type)&&-1!==e.indexOf(a.authority_id)&&t.push(a.authority_id)}),t}),x(C(C(a)),"init_role_from",function(){a.setState({role_name:"",role_description:""})}),x(C(C(a)),"edit_role",function(e){a.setState({visible_create_role_modal:!0,is_create:!1,role_name:e.role_name,role_description:e.role_description})}),x(C(C(a)),"delete_role",function(){var e=a.props.state_admin_role.current_role_info;T({title:"\u786e\u8ba4\u8981\u5220\u9664\u5f53\u524d\u89d2\u8272\u5417?",content:"\u5220\u9664\u5f53\u524d\u89d2\u8272\u4f1a\u5220\u9664\u89d2\u8272\u7528\u6237\u5173\u8054\uff0c\u4ee5\u53ca\u89d2\u8272\u6743\u9650\u5173\u8054",okText:"\u662f",okType:"danger",cancelText:"\u5426",onOk:function(){var t=w(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.props.dispatch(Object(h.b)({role_id:e.role_id},function(e){a.fetch_admin_role_list()}));case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),onCancel:function(){console.log("Cancel")}})}),x(C(C(a)),"handleOk",function(){a.state.is_create?a.fetch_admin_create_role():a.fetch_admin_edit_role()}),x(C(C(a)),"handleCancel",function(e){a.setState({visible_create_role_modal:!1})}),x(C(C(a)),"handleTableChange",function(){var e=w(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return{}.current=t.current,e.next=4,a.setState({pagination:{current:t.current}});case 4:a.fetch_admin_role_list();case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()),x(C(C(a)),"fetch_admin_edit_role",function(){a.props.dispatch(Object(h.c)({role_id:a.props.state_admin_role.current_role_info.role_id,role_name:a.state.role_name,role_description:a.state.role_description},function(){p.a.message_success("\u4fee\u6539\u89d2\u8272\u6210\u529f"),a.fetch_admin_role_list(),a.setState({visible_create_role_modal:!1})}))}),x(C(C(a)),"fetch_admin_create_role",function(){var e={role_name:a.state.role_name,role_description:a.state.role_description};a.props.dispatch(Object(h.a)(e,function(){p.a.message_success("\u89d2\u8272\u521b\u5efa\u6210\u529f"),a.fetch_admin_role_list(),a.setState({visible_create_role_modal:!1})}))}),x(C(C(a)),"fetch_set_admin_role_authority",function(){var e=a.props.state_admin_role,t=e.current_role_info,n=e.role_authority_list_all;console.log("role_authority_list_all",n),a.props.dispatch(Object(h.f)(g({},t,{role_authority_list:n}),function(){p.a.message_success("\u89d2\u8272\u6743\u9650\u8bbe\u7f6e\u6210\u529f"),a.setState({visible_set_authority_modal:!1})}))}),x(C(C(a)),"fetch_admin_role_list",function(){var e=C(C(a));a.setState({loading:!0});var t=a.state.pagination.current;a.props.dispatch(Object(h.e)({params:{page:t}},function(a){var n=g({},e.state.pagination);n.total=a.count,n.current=t,e.setState({loading:!1,pagination:n})}))}),x(C(C(a)),"onCheck",function(e,t){console.log("event",t),a.setState({role_authority_list:e}),a.props.dispatch({type:"SET_ROLE_AUTHORITY_LIST_ALL",data:v(e).concat(v(t.halfCheckedKeys))})}),x(C(C(a)),"renderTreeNodes",function(e){return e.map(function(e){return e.children.length>0?d.a.createElement(j,{dataRef:e,key:e.authority_id,title:e.authority_name,type:e.type},a.renderTreeNodes(e.children)):d.a.createElement(j,{key:e.authority_id,title:e.authority_name})})}),a.state={columns:[{title:"\u89d2\u8272id",dataIndex:"role_id",key:"role_id"},{title:"\u89d2\u8272\u540d\u5b57",dataIndex:"role_name",key:"role_name"},{title:"\u89d2\u8272\u63cf\u8ff0",dataIndex:"role_description",key:"role_description"},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){return d.a.createElement("div",{className:"table-right-btn"},d.a.createElement(o.a,{onClick:w(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.edit_role(t),e.next=3,a.props.dispatch({type:"SET_CURRENT_ROLE_INFO",data:t});case 3:case"end":return e.stop()}},e,this)})),size:"small",type:"primary"},"\u4fee\u6539"),d.a.createElement(o.a,{className:"box-btn-red",onClick:w(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.dispatch({type:"SET_CURRENT_ROLE_INFO",data:t});case 2:a.delete_role();case 3:case"end":return e.stop()}},e,this)})),size:"small"},"\u5220\u9664"),d.a.createElement(o.a,{className:"box-btn-orange",onClick:w(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({visible_set_authority_modal:!0}),e.next=3,a.props.dispatch(Object(h.d)({params:g({},t)},function(e){console.log("res",e),a.setState({role_authority_list:a.init_tree_data(e)})}));case 3:return e.next=5,a.props.dispatch({type:"SET_CURRENT_ROLE_INFO",data:t});case 5:case"end":return e.stop()}},e,this)})),size:"small"},"\u8bbe\u7f6e\u6743\u9650"))}}],pagination:{},loading:!1,visible_create_role_modal:!1,visible_set_authority_modal:!1,role_name:"",role_description:"",is_create:!0,role_authority_list:[]},a}var a,l,s;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,d.a.Component),a=t,(l=[{key:"componentDidMount",value:function(){this.fetch_admin_role_list(),this.props.dispatch(Object(m.c)())}},{key:"render",value:function(){var e=this,t=this.props,a=t.state_admin_role,l=t.state_admin_authority,s=this.state,_=s.loading,f=s.role_name,p=s.role_description,m=s.is_create,h={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}};return d.a.createElement("div",{className:"layout-main"},d.a.createElement("div",{className:"layout-main-title"},d.a.createElement(r.a,{type:"user"})," ",d.a.createElement("em",null,"\u6743\u9650\u83dc\u5355")),d.a.createElement("div",{className:"layout-nav-btn"},d.a.createElement(o.a,{className:"admin-role-create-btn layout-btn",icon:"plus",onClick:this.showModal,type:"primary"},"\u521b\u5efa\u89d2\u8272")),d.a.createElement("div",{className:"admin-role"},d.a.createElement(c.a,{footer:null,onCancel:this.handleCancel,title:"\u521b\u5efa\u89d2\u8272",visible:this.state.visible_create_role_modal},d.a.createElement(R,y({},h,{label:"\u89d2\u8272\u540d"}),d.a.createElement(i.a,{className:"input-view",onChange:function(t){e.setState({role_name:t.target.value})},placeholder:"\u8bf7\u586b\u5199\u89d2\u8272\u540d",value:f})),d.a.createElement(R,y({},h,{label:"\u89d2\u8272\u63cf\u8ff0"}),d.a.createElement(N,{autosize:{minRows:2,maxRows:6},onChange:function(t){e.setState({role_description:t.target.value})},placeholder:"\u8bf7\u586b\u5199\u89d2\u8272\u63cf\u8ff0",value:p})),d.a.createElement(R,{wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:4}}},d.a.createElement(o.a,{className:"register-btn",htmlType:"submit",onClick:this.handleOk,type:"primary"},m?"\u521b\u5efa":"\u66f4\u65b0"))),d.a.createElement(c.a,{footer:null,onCancel:function(){e.setState({visible_set_authority_modal:!1})},title:"\u8bbe\u7f6e\u6743\u9650",visible:this.state.visible_set_authority_modal},d.a.createElement(u.a,{checkable:!0,checkedKeys:this.state.role_authority_list,onCheck:this.onCheck,ref:"tree",showLine:!0},this.renderTreeNodes(l.admin_authority_list)),d.a.createElement("div",{className:"admin-role-foot"},d.a.createElement(o.a,{icon:"save",onClick:function(){e.fetch_set_admin_role_authority()},type:"primary"},"\u786e\u5b9a"),d.a.createElement(o.a,{onClick:function(){e.setState({visible_set_authority_modal:!1})}},"\u53d6\u6d88"))),d.a.createElement("div",{className:"layout-table"},d.a.createElement(n.a,{columns:this.state.columns,dataSource:a.admin_role_list,loading:_,onChange:this.handleTableChange.bind(this),pagination:this.state.pagination,rowKey:"role_id"}))))}}])&&E(a.prototype,l),s&&E(a,s),t}();t.default=Object(f.connect)(function(e){return{state_admin_role:e.state_admin_role,state_admin_authority:e.state_admin_authority}})(P)},"489c92a1cf4a91fcd1a4":function(e,t,a){}}]);